<div lj-type="frame" id="typeformframe" lj-fit-to="responsive" lj-transition="fade">
  <a href="#lmodal.!none;menubackdrop.!none" class="menu-close icon-cross"></a>
  <div class="typeform-widget" data-url="https://layerjs.typeform.com/to/vUX8AS" data-transparency="50" data-hide-headers="true"
    data-hide-footer="true" style="width: 100%; height: 100%;"></div>
  <script>
    (function () {
      var qs,
        js,
        q,
        s,
        d = document,
        gi = d.getElementById,
        ce = d.createElement,
        gt = d.getElementsByTagName,
        id = "typef_orm",
        b = "https://embed.typeform.com/";
      if (!gi.call(d, id)) {
        js = ce.call(d, "script");
        js.id = id;
        js.src = b + "embed.js";
        q = gt.call(d, "script")[0];
        q.parentNode.insertBefore(js, q)
      }
    })()
  </script>
  <!--<div style="font-family: Sans-Serif;font-size: 12px;color: #999;opacity: 0.5; padding-top: 5px;">
    powered by
    <a href="https://admin.typeform.com/signup?utm_campaign=vUX8AS&utm_source=typeform.com-3941375-Basic&utm_medium=typeform&utm_content=typeform-embedded-poweredbytypeform&utm_term=EN"
      style="color: #999" target="_blank">Typeform</a>
  </div>-->
  <section>
    <br>
    <br>
    <div class="container" style="display:none">
      <h2>
        Thank you for your feedback!
      </h2>
      <p>
        We will continue improving layerJS! Signup to our
        <a href="#lmodal.!none;menubackdrop.!none;menuframe">newsletter</a> to stay up to date or contact us directly at
        <a href="mailto:developers@layerjs.org">developers@layerjs.org</a> if you have any questions or comments.
      </p>
      <div class="full_cta">
        <a class="btn btn-key" href="#lmodal.!none;menubackdrop.!none">Close</a>
      </div>
    </div>
  </section>
  <script>
    deferReady(function () {
      var exitintent = true;
      var lasttime = false;
      if (!document.cookie.match(/typeform\-popup\=/)) {
        setTimeout(function () {
          // window.addEventListener('mouseout', function (e) {
          //   if (e.toElement !== null) return;
          //   if (exitintent) {
          //     layerJS.router.navigate('#backdrop;typeformframe;menulayer.!none');
          //     if (!lasttime) {
          //       setTimeout(function () {
          //         exitintent = true;
          //         lasttime = true;
          //       }, 120000);
          //     }
          //   }
          //   exitintent = false;
          // });
          layerJS.router.navigate('#backdrop;typeformframe;menulayer.!none');
          if (!lasttime) {
            setTimeout(function () {
              layerJS.router.navigate('#backdrop;typeformframe;menulayer.!none');
              lasttime = true;
            }, 120000);
          }
          exitintent = false;

        }, 30000);
      }
      document.querySelector('#typeformframe .menu-close').addEventListener('click', function (event) {
        if (!document.cookie.match(/typeform\-popup\=success/)) {
          document.cookie = "typeform-popup=closed;path=/;max-age=" + 60 * 60 * 24;
        }
      });
      window.addEventListener('message', function (event) {
        if (event.origin.match(/layerjs\.typeform/) && event.data === 'form-submit') {
          document.cookie = "typeform-popup=success;path=/;max-age=" + 60 * 60 * 24 * 365;
          document.querySelector('#typeformframe .typeform-widget').remove();
          document.querySelector('#typeformframe .container').style.display = 'block';
          lasttime = true;
        }
      });
      var decorateIframe = function () {
        var gobj = window[window.GoogleAnalyticsObject];
        var iframe = document.querySelector('#typeformframe .typeform-widget iframe');
        if (!iframe) {
          setTimeout(decorateIframe, 500);
          return;
        }
        var tracker, linker;
        if (gobj) {
          tracker = gobj.getAll()[0];
          linker = new window.gaplugins.Linker(tracker);
          iframe.src = linker.decorate(iframe.src);
        }
      }
      setTimeout(decorateIframe, 2000);
      var typeformfixed = false;
      layerJS.select('#lmodal').on('transitionStarted', function (name) {
        if (name === 'typeformframe' && !typeformfixed) {
          typeformfixed = true;
          // fix typeform fuckup on mobile where it shows a start page to start the typeform.
          document.querySelector('#typeformframe [data-qa="start-button"]').dispatchEvent(new Event('click', { bubbles: true }));
        }
      })
    });
  </script>
</div>